Vol:.(1234567890)

The abnormalities can only be explained by expert radiologists. With the huge number of suspected cases and the limited number of available radiologists, automatic methodologies for the recognition of these precise abnormalities can aid in early diagnosis with high accuracy. The studies in Artificial Intelligence (AI) and machine learning, especially Deep Learning (DL), achieved high performance in the diagnosis of medical images. Therefore, DL techniques are robust tools for such issues.

Deep learning (DL) has been successfully used to predict COVID-19 from Chest images. Unlike the traditional machine learning techniques DL can be used to predict disease from raw images without feature extraction required. The role of deep learning is to learn the features using a trained model with a huge amount of data to improve the classification's accuracy which reduces the burden on physicians and decreases the effect of doctors' shortages of the struggle against the disease. Convolutional neural network (CNN) is the type of DL model intended for image analysis tasks and has already been utilized in many medical problems such as segmentation and   classification 12 .

Many high-performing pre-trained CNN structures have been provided in the literature to be utilized in similar problems. These models were trained using ImageNet data which contains 1,000,000 images and 1000 classes to overcome the limitation of data and to reduce the training   time 13 . These models can be used for image recognition based on transfer learning after fine-tuning these networks to the new problems. The learned weights of these pre-trained models are provided and used directly in the new   problems 14 . The purpose of utilizing pretrained models is to take advantage of learned features on a larger dataset, therefore the new model can converge faster and perform better with a smaller dataset. This gives us the advantage of DL independence of feature engineering over traditional methods without giving up the time, computational resources and cost effeciencies. Examples of these pre-trained CNN models are visual geometry group VGG (16, 19) 15 , EfficientNet (B0 to B7) 16 , MobileNet 17 , and residual neural network (ResNet) 18 , etc.

The contributions of this research can be summarized as follows:

- · A framework has been developed to diagnose COVID-19 using chest X-ray images for both full and segmented images.
- · A multiplication between each original image and the associated lung mask from the ground truth dataset provided by the database has been applied to get the segmented lung.
- · Different image enhancement techniques have been applied to both full and segmented X-ray images to reach the best possible classification performance.
- · CNN pre-trained models based on transfer learning have been used to classify both full and segmented chest X-ray images with all enhancement versions and achieved promising results.
- · Since the purpose of utilizing pre-trained models is to take advantage of learned features on a larger dataset, therefore the smallest possible datasets that can achieve the best possible performance have been used for faster convergence.

Recently, many works have been developed to detect and diagnose COVID-19 and other lung diseases based on different medical image modalities using different machine learning techniques especially deep learning and transfer learning techniques. The purpose of all these works is to improve the performances of the methodologies used in the detection and classification of COVID-19 and other lung diseases. The focus in the research will be in X-ray images as the adopted medical image modality in this research.

The rest of the paper is organized as follows. Related COVID-19 articles using deep learning are reviewed in the 'Related work' section. Then, the proposed framework for COVID-19 classification is described in "The proposed framework" section. Next, the results of X-ray images obtained with the proposed framework are presented in "Experimental results" section. The discussion and comparison with literature are provided in "Discussion" section. Finally, the main 'Conclusions and future work' are outlined.